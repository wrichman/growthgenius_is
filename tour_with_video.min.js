webpackJsonp([22],{0:function(t,e){t.exports=function(t){if(typeof execScript!=="undefined")execScript(t);else eval.call(null,t)}},4127:function(t,e,n){n(0)(n(4128))},4128:function(t,e){t.exports="/**\n * A tour with video\n * @module tour_with_video\n */\n;(function () {\n\t'use strict';\n\n\tvar tour_with_video = {\n\t\tanimation_time: 125,\n\t\tis_video_shown: false,\n\t\tplayer: null,\n\t\taspect_ratio: 16 / 9,\n\n\t\t/**\n   * Setup work to play video. Caches DOM elements and Wistia API object.\n   *\n   * @return {void}\n   */\n\t\tinit: function init() {\n\t\t\tvar self = this;\n\n\t\t\tself._loadIframeAPI();\n\n\t\t\t// This function creates an <iframe> (and YouTube player) after the API code downloads.\n\t\t\t// needs to be available at the global level - http://stackoverflow.com/a/15375225\n\t\t\twindow.onYouTubeIframeAPIReady = function () {\n\t\t\t\tself.player = new YT.Player('watch_the_tour', { // eslint-disable-line no-undef\n\t\t\t\t\tvideoId: '9RJZMSsH7-g', // eslint-disable-line slack/var-name\n\n\t\t\t\t\tiv_load_policy: 3,\n\t\t\t\t\tmodestbranding: 1,\n\t\t\t\t\trel: 0,\n\t\t\t\t\tshowinfo: 0,\n\t\t\t\t\tcontrols: 0,\n\t\t\t\t\tenablejsapi: 1,\n\n\t\t\t\t\tevents: {\n\t\t\t\t\t\tonReady: function onReady() {\n\t\t\t\t\t\t\tself._setup();\n\t\t\t\t\t\t},\n\n\t\t\t\t\t\tonStateChange: function onStateChange(event) {\n\t\t\t\t\t\t\t// in case a resize happens:\n\t\t\t\t\t\t\t// - after video ends\n\t\t\t\t\t\t\t// - while it's buffering\n\t\t\t\t\t\t\t// - while it's paused\n\t\t\t\t\t\t\tif (event.data == 0 || 2 || 3) {\n\t\t\t\t\t\t\t\tself.updateVideoSize();\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t// video has ended\n\t\t\t\t\t\t\tif (event.data == 0) {\n\t\t\t\t\t\t\t\tself.hideVideo();\n\n\t\t\t\t\t\t\t\t// video is playing\n\t\t\t\t\t\t\t} else if (event.data == 1) {\n\t\t\t\t\t\t\t\t// re-use handler we set up in `_subscribeHandlers()`\n\t\t\t\t\t\t\t\tself.$video_container.find('.hero_image_overlay').trigger('click');\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t};\n\t\t},\n\n\t\t_loadIframeAPI: function _loadIframeAPI() {\n\t\t\tvar tag = document.createElement('script');\n\t\t\ttag.src = 'https://www.youtube.com/iframe_api';\n\t\t\tvar first_script_tag = document.getElementsByTagName('script')[0];\n\t\t\tfirst_script_tag.parentNode.insertBefore(tag, first_script_tag);\n\t\t},\n\n\t\t_setup: function _setup() {\n\t\t\tthis.$top = $('.top:not(\".persistent\")');\n\t\t\tthis.$video_container = $('.video_header');\n\t\t\tthis.$hero_image_overlay = $('.hero_image_overlay');\n\t\t\tthis.$close_video = $('.close_video');\n\t\t\tthis.$tour_btn = $('.tour_btn');\n\t\t\tthis.$player = $(this.player.getIframe());\n\t\t\tthis.stored_offset = 0;\n\t\t\tthis.container_height = this.$hero_image_overlay.height();\n\n\t\t\tthis.width = Math.ceil(document.documentElement.clientWidth);\n\t\t\tthis.height = Math.floor(this.width / this.aspect_ratio);\n\n\t\t\t// we replace the inline style display: none to prevent video flickering when loaded\n\t\t\tthis.$player.css({\n\t\t\t\theight: this.container_height,\n\t\t\t\twidth: this.width,\n\t\t\t\tdisplay: 'block'\n\t\t\t});\n\n\t\t\tthis._subscribeHandlers();\n\t\t},\n\n\t\t/**\n   * Event handlers for video\n   *\n   * @return {void}\n   */\n\t\t_subscribeHandlers: function _subscribeHandlers() {\n\t\t\tvar self = this;\n\n\t\t\t// monkeypatch Youtube API. calls handler to animate video in\n\t\t\tvar _original_play_video = this.player.playVideo;\n\t\t\tthis.player.playVideo = function () {\n\t\t\t\tself.showVideo();\n\t\t\t\tself.$hero_image_overlay.removeClass('no_events');\n\t\t\t\treturn _original_play_video.apply(this, arguments);\n\t\t\t};\n\n\t\t\t// Clicking on the big hero image to activate video\n\t\t\tthis.$video_container.on('click', '.hero_image_overlay', function () {\n\t\t\t\tself.player.playVideo();\n\t\t\t});\n\n\t\t\tthis.$close_video.on('click', function () {\n\t\t\t\tself.player.pauseVideo();\n\t\t\t\tself.hideVideo();\n\t\t\t});\n\n\t\t\t$(window).on('resize', _.debounce(function (e) {\n\t\t\t\tself.updateVideoSize(e);\n\t\t\t}, 10));\n\n\t\t\t// we pause and hide video on esc key\n\t\t\t$('body').on('keydown', _.debounce(function (e) {\n\t\t\t\tif (e.which === 27) {\n\t\t\t\t\tself.player.pauseVideo();\n\t\t\t\t\tself.hideVideo();\n\t\t\t\t}\n\t\t\t}, 10));\n\t\t},\n\n\t\t/**\n   * Update cached dimensions.  Use this info to preserve video aspect ratio\n   *\n   * @return {void}\n   */\n\t\tupdateVideoSize: function updateVideoSize() {\n\t\t\tvar _old_width = this.width;\n\t\t\tvar _new_width = Math.ceil(document.documentElement.clientWidth);\n\n\t\t\t// doesn't really matter if height changes, but if _width_ changes, then we ride.\n\t\t\tif (_new_width != _old_width && this.is_video_shown) {\n\t\t\t\t// refresh dims\n\t\t\t\tthis.width = _new_width;\n\t\t\t\tthis.height = Math.floor(_new_width / this.aspect_ratio);\n\t\t\t\tthis.$video_container.css('height', this.height);\n\t\t\t}\n\t\t},\n\n\t\t/**\n   * Animates the video in. Animates the nav and image out\n   *\n   * @return {void}\n   */\n\t\tshowVideo: function showVideo() {\n\t\t\tif (!this.is_video_shown) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tthis.is_video_shown = true;\n\t\t\t\tthis.$player.removeClass('stealth');\n\t\t\t\tthis.$hero_image_overlay.addClass('stealth no_pointer_events');\n\t\t\t\tthis.$top.addClass('hidden');\n\t\t\t\tthis.$tour_btn.addClass('stealth hidden');\n\n\t\t\t\tthis.$video_container.css({\n\t\t\t\t\theight: this.height\n\t\t\t\t}, this.animation_time);\n\n\t\t\t\tthis.$player.css({\n\t\t\t\t\theight: '100%',\n\t\t\t\t\twidth: '100%'\n\t\t\t\t});\n\n\t\t\t\tthis.$close_video.removeClass('hidden');\n\n\t\t\t\t// save offset, and jump to top of video container\n\t\t\t\tthis.stored_offset = $(document).scrollTop();\n\t\t\t\tvar container_top = self.$video_container.offset().top + 1;\n\t\t\t\t$('html, body').animate({ scrollTop: container_top }, 200); // eslint-disable-line slack/var-name\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.$close_video.addClass('show');\n\t\t\t\t}, 0);\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.$video_container.css('height', self.height);\n\n\t\t\t\t\t// We need to add no_transition to fix a Safari flickering bug\n\t\t\t\t\tself.$video_container.addClass('no_transition');\n\t\t\t\t}, this.animation_time);\n\t\t\t}\n\t\t},\n\n\t\t/**\n   * Animates the video out. Animates the nav and image in\n   *\n   * @return {void}\n   */\n\t\thideVideo: function hideVideo() {\n\t\t\tif (this.is_video_shown) {\n\t\t\t\tvar self = this;\n\n\t\t\t\tthis.$video_container.css('height', this.$player.height());\n\t\t\t\tthis.$top.removeClass('hidden').addClass('stealth');\n\t\t\t\tthis.$tour_btn.removeClass('hidden');\n\t\t\t\tthis.$top.removeClass('hidden').addClass('stealth');\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.$top.removeClass('stealth');\n\t\t\t\t\tself.$tour_btn.removeClass('stealth');\n\t\t\t\t\tself.$close_video.removeClass('show');\n\t\t\t\t\tself.$video_container.css('height', self.container_height);\n\t\t\t\t\tself.$hero_image_overlay.css('height', self.container_height);\n\n\t\t\t\t\t// We need to remove no_transition to fix a Safari flickering bug\n\t\t\t\t\tself.$video_container.removeClass('no_transition');\n\n\t\t\t\t\t// jump back to previous offset\n\t\t\t\t\t$('html, body').animate({ scrollTop: self.stored_offset }, 200);\n\t\t\t\t}, 0);\n\n\t\t\t\tsetTimeout(function () {\n\t\t\t\t\tself.$hero_image_overlay.removeClass('stealth no_pointer_events');\n\t\t\t\t\tself.$player.addClass('stealth');\n\t\t\t\t\tself.$close_video.addClass('hidden');\n\t\t\t\t\tself.is_video_shown = false;\n\t\t\t\t}, this.animation_time);\n\t\t\t}\n\t\t}\n\t};\n\n\ttour_with_video.init();\n\n\twindow.tour_with_video = tour_with_video;\n})();"}},[4127]);